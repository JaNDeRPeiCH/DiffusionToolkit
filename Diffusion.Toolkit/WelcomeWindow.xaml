<local:BorderlessWindow x:Class="Diffusion.Toolkit.WelcomeWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Diffusion.Toolkit"
        mc:Ignorable="d"
        xmlns:converters="clr-namespace:Diffusion.Toolkit.Converters"
        xmlns:lex="http://wpflocalizeextension.codeplex.com"
        lex:LocalizeDictionary.Provider="{StaticResource LocalizationProvider}"
        lex:LocalizeDictionary.Separation="."
        lex:LocalizeDictionary.DefaultProvider="{StaticResource LocalizationProvider}"
        d:DataContext="{d:DesignInstance local:WelcomeModel, IsDesignTimeCreatable = True}"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        MenuWidth="0"
        TitleWidth="*"
        WindowStyle="ToolWindow"
        Style="{StaticResource BorderlessWindowStyle}"
        ResizeMode="NoResize"
        Title="Welcome" Height="500" Width="600">
    <Window.Resources>
        <ResourceDictionary>
            <converters:ValueVisibilityConverter x:Key="ValueVisible"></converters:ValueVisibilityConverter>
            <local:WelcomeModel x:Key="SampleData" Step="2">
            </local:WelcomeModel>
        </ResourceDictionary>
    </Window.Resources>
    <Window.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding Escape}"></KeyBinding>
    </Window.InputBindings>
    <Grid Margin="10" d:DataContext="{StaticResource SampleData}">
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="26"/>
        </Grid.RowDefinitions>
        <Grid Margin="10" Visibility="{Binding Step, Converter={StaticResource ValueVisible}, ConverterParameter=1}">
            <StackPanel Background="Transparent">
                <Label FontSize="24" FontWeight="DemiBold">Welcome to Diffusion Toolkit!</Label>
                <Label FontSize="18">Let's get you started!</Label>
            </StackPanel>
        </Grid>
        <Grid Margin="10" Visibility="{Binding Step, Converter={StaticResource ValueVisible}, ConverterParameter=2}">
            <StackPanel Grid.Row="0">
                <Label FontSize="18" FontWeight="DemiBold">Select the folders you want to scan</Label>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" FontSize="12" Margin="5" TextWrapping="Wrap">These folders will be watched for new content and will be scanned recursively. You can change these settings later.</TextBlock>
                <Grid Height="120" VerticalAlignment="Top" Margin="5,5,5,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="120"/>
                    </Grid.ColumnDefinitions>
                    <ListBox ItemsSource="{Binding ImagePaths}" SelectedIndex="{Binding SelectedIndex}" Margin="0,0,10,0"></ListBox>
                    <StackPanel Grid.Column="1">
                        <Button Click="AddFolder_OnClick" Margin="0,0,0,10" Height="26" Content="{lex:Loc Settings.General.AddFolder}"></Button>
                        <Button Click="RemoveFolder_OnClick" Margin="0,0,0,10" Height="26" Content="{lex:Loc Settings.General.RemoveFolder}"></Button>
                    </StackPanel>
                </Grid>
                <CheckBox IsChecked="{Binding ScanForNewImagesOnStartup}" Margin="5,0,0,0" Content="{lex:Loc Settings.Images.ScanForNewImagesOnStartup}"></CheckBox>
                <!--<StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <CheckBox x:Name="WatchFolders" IsChecked="{Binding WatchFolders}" ToolTip="{lex:Loc Settings.General.WatchFolders.ToolTip}" Content="{lex:Loc Settings.General.WatchFolders}"></CheckBox>
                    <CheckBox IsChecked="{Binding AutoRefresh}" Margin="10,0,0,0" ToolTip="{lex:Loc Settings.General.General.ToolTip}"  Content="{lex:Loc Settings.General.AutoRefresh}"></CheckBox>
                    <CheckBox IsChecked="{Binding RecurseFolders}" Margin="10,0,0,0"  VerticalContentAlignment="Center" ToolTip="{lex:Loc Settings.General.Recursive.ToolTip}" Content="{lex:Loc Settings.General.Recursive}"></CheckBox>
                </StackPanel>-->
                <!--<Label>Scan these file types</Label>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="120"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Height="26" VerticalContentAlignment="Center" Text="{Binding FileExtensions, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,10,0"></TextBox>
                </Grid>-->
            </StackPanel>
        </Grid>
        <Grid Margin="10" Visibility="{Binding Step, Converter={StaticResource ValueVisible}, ConverterParameter=3}">
            <StackPanel Grid.Row="0">
                <Label FontSize="18" FontWeight="DemiBold">Select additional metadata for searching</Label>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" FontSize="12" Margin="5" TextWrapping="Wrap">
                    By default Diffusion Toolkit will store basic supported metadata. You may chose to store additional metadata as needed.
                </TextBlock>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" Margin="5" TextWrapping="Wrap">
                    Check this option if you use ComfyUI and you want to search in ComfyUI Node Properties. 
                </TextBlock>
                <CheckBox IsChecked="{Binding StoreWorkflow}" Margin="20,15,0,15" Content="{lex:Loc Settings.Metadata.StoreWorkflow}"></CheckBox>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" Margin="5" TextWrapping="Wrap">
                    Check this option if you want to store the raw metadata and use it for searching. You will need to enable Raw Metadata Search in the Search Bar Settings.
                </TextBlock>
                <CheckBox IsChecked="{Binding StoreMetadata}" Margin="20,15,0,15" Content="{lex:Loc Settings.Metadata.StoreMetadata}"></CheckBox>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" Margin="5" TextWrapping="Wrap" Text="{lex:Loc Settings.Metadata.Warning}"></TextBlock>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" Margin="5,10" TextWrapping="Wrap">You can change these settings later.</TextBlock>
            </StackPanel>
        </Grid>
        <Grid Margin="10" Visibility="{Binding Step, Converter={StaticResource ValueVisible}, ConverterParameter=4}">
            <StackPanel Grid.Row="0">
                <Label FontSize="18" FontWeight="DemiBold">All set!</Label>
                <TextBlock Foreground="{DynamicResource ForegroundBrush}" FontSize="12" Margin="5" TextWrapping="Wrap">
                    Diffusion Toolkit will now scan your folders.  You can begin searching and viewing images as soon as any images have been scanned.
                    Press CTRL+F5 or hold CTRL and click the Refresh button to reload search results.
                </TextBlock>
            </StackPanel>
        </Grid>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Button Grid.Column="0" Click="Back_OnClick" IsEnabled="{Binding NotStart}">Back</Button>
            <Button Grid.Column="1" Click="Next_OnClick" Content="{Binding NextButton}"></Button>
        </Grid>
    </Grid>
</local:BorderlessWindow>
